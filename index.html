<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Background Remover - Modern AI Tool</title>
  <meta name="description" content="Remove image backgrounds instantly with our modern AI-powered tool. Fast, free, and privacy-friendly. Supports PNG, JPG, and WEBP. Perfect for designers, creators, and everyone!">
  <link rel="apple-touch-icon" sizes="180x180" href="public/favicon.svg">
  <link rel="icon" type="image/svg+xml" sizes="32x32" href="public/favicon.svg">
  <link rel="icon" type="image/svg+xml" sizes="16x16" href="public/favicon.svg">
  <link rel="shortcut icon" href="public/favicon.svg">
  <meta property="og:title" content="Background Remover | Modern AI Tool">
  <meta property="og:description" content="Remove image backgrounds instantly with our modern AI-powered tool. Fast, free, and privacy-friendly. Supports PNG, JPG, and WEBP. Perfect for designers, creators, and everyone!">
  <meta property="og:image" content="https://i.ibb.co/qYzGC0DW/og-img.jpg">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="1200">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://drbaph.is-a.dev/RemoveBG/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Background Remover | Modern AI Tool">
  <meta name="twitter:description" content="Remove image backgrounds instantly with our modern AI-powered tool. Fast, free, and privacy-friendly. Supports PNG, JPG, and WEBP. Perfect for designers, creators, and everyone!">
  <meta name="twitter:image" content="https://i.ibb.co/qYzGC0DW/og-img.jpg">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2/src/regular/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.2/src/duotone/style.css">

  <style>
    :root {
      --primary: 99, 102, 241;
      --secondary: 236, 72, 153;
    }

    * {
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    /* Gradient backgrounds */
    .gradient-bg {
      background: linear-gradient(135deg, rgb(var(--primary)) 0%, rgb(var(--secondary)) 100%);
    }

    .gradient-text {
      background: linear-gradient(135deg, rgb(var(--primary)) 0%, rgb(var(--secondary)) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Glass effect */
    .glass {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background: rgba(255, 255, 255, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.8);
    }

    .dark .glass {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Special glass for GitHub button */
    .glass-github {
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      background: rgba(31, 41, 55, 0.08);
      border: 1px solid rgba(31, 41, 55, 0.12);
    }

    .dark .glass-github {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Dropzone styles */
    .dropzone {
      position: relative;
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .dropzone::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(99, 102, 241, 0.05);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .dark .dropzone::before {
      background: rgba(99, 102, 241, 0.1);
    }

    .dropzone.dragover::before {
      width: 600px;
      height: 600px;
    }

    .dropzone:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    /* Modern loader */
    .progress-ring {
      transform: rotate(-90deg);
    }

    .progress-ring__circle {
      stroke-dasharray: 251.2;
      stroke-dashoffset: 251.2;
      transition: stroke-dashoffset 0.35s;
      transform-origin: center;
    }

    @keyframes pulse-ring {
      0% {
        transform: scale(0.95);
        opacity: 1;
      }
      50% {
        transform: scale(1.05);
        opacity: 0.7;
      }
      100% {
        transform: scale(0.95);
        opacity: 1;
      }
    }

    .pulse-animation {
      animation: pulse-ring 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    /* Floating animation */
    @keyframes float {
      0%, 100% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    .float-animation {
      animation: float 3s ease-in-out infinite;
    }

    /* Button hover effects */
    .btn-primary {
      position: relative;
      overflow: hidden;
      z-index: 1;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
      z-index: -1;
    }

    .btn-primary:hover::before {
      width: 300px;
      height: 300px;
    }

    /* Theme toggle */
    .theme-toggle {
      position: relative;
      width: 60px;
      height: 30px;
      background: #d1d5db;
      border-radius: 15px;
      cursor: pointer;
      transition: background 0.3s;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    }

    .dark .theme-toggle {
      background: #4b5563;
    }

    .theme-toggle-dot {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dark .theme-toggle-dot {
      transform: translateX(30px);
    }

    /* Image result animations */
    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .slide-up {
      animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Responsive grid background */
    .grid-bg {
      background-image: 
        linear-gradient(rgba(99, 102, 241, 0.01) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 102, 241, 0.01) 1px, transparent 1px);
      background-size: 50px 50px;
    }

    .dark .grid-bg {
      background-image: 
        linear-gradient(rgba(99, 102, 241, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(99, 102, 241, 0.05) 1px, transparent 1px);
    }

    /* Breathing green dot for model indicator */
    .model-indicator {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 50;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(255,255,255,0.7);
      border-radius: 9999px;
      padding: 0.35rem 0.85rem 0.35rem 0.5rem;
      box-shadow: 0 2px 8px 0 rgba(0,0,0,0.04);
      font-size: 1rem;
      font-weight: 500;
      color: #16a34a;
      pointer-events: none;
      user-select: none;
    }
    .dark .model-indicator {
      background: rgba(31,41,55,0.7);
      color: #22d3ee;
    }
    .breathing-dot {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 0 0 rgba(34,197,94,0.7);
      animation: breathing-dot 1.6s infinite cubic-bezier(0.4,0,0.2,1);
      flex-shrink: 0;
    }
    @keyframes breathing-dot {
      0%, 100% {
        box-shadow: 0 0 0 0 rgba(34,197,94,0.7);
        opacity: 1;
      }
      50% {
        box-shadow: 0 0 0 8px rgba(34,197,94,0.15);
        opacity: 0.7;
      }
    }

    @media (max-width: 640px) {
      .min-h-screen.flex.flex-col.items-center.justify-center {
        padding-top: 4.5rem !important;
      }
    }
  </style>
</head>
<body class="bg-white dark:bg-gray-900 min-h-screen grid-bg transition-all duration-300">
  <!-- Theme Toggle -->
  <div class="fixed top-4 right-4 z-50">
    <div class="theme-toggle" id="themeToggle">
      <div class="theme-toggle-dot">
        <i class="ph-duotone ph-sun text-yellow-500 text-sm dark:hidden"></i>
        <i class="ph-duotone ph-moon text-gray-400 text-sm hidden dark:block"></i>
      </div>
    </div>
  </div>

  <!-- Model Indicator -->
  <div id="modelIndicator" class="model-indicator" style="display:none">
    <span class="breathing-dot"></span>
    <span id="modelLabel">Model: Small</span>
  </div>

  <!-- Main Container -->
  <div class="min-h-screen flex flex-col items-center justify-center p-4 md:p-8 pb-24 md:pb-8 pt-20 sm:pt-8">
    <div class="w-full max-w-4xl">
      <!-- Header -->
      <div class="text-center mb-8 md:mb-12">
        <h1 class="text-4xl md:text-6xl font-bold mb-4">
          <span class="gradient-text">Background Remover</span>
        </h1>
        <p class="text-gray-600 dark:text-gray-400 text-lg md:text-xl">
          AI-powered background removal in seconds
        </p>
      </div>

      <!-- Main Card -->
      <div class="glass rounded-3xl p-6 md:p-10 shadow-2xl">
        <!-- Dropzone -->
        <div
          id="dropzone"
          class="dropzone bg-gray-50 dark:bg-gray-800 rounded-2xl p-8 md:p-16 text-center cursor-pointer border-2 border-dashed border-gray-200 dark:border-gray-600 hover:border-indigo-500 dark:hover:border-indigo-400"
        >
          <div class="float-animation">
            <i class="ph-duotone ph-image text-6xl md:text-8xl text-gray-400 dark:text-gray-500 mb-4"></i>
          </div>
          <p class="text-xl md:text-2xl font-medium text-gray-700 dark:text-gray-300 mb-2">
            Drop your image here
          </p>
          <p class="text-gray-500 dark:text-gray-400">
            or <span class="text-indigo-600 dark:text-indigo-400 font-semibold">browse</span> to upload
          </p>
          <p class="text-sm text-gray-400 dark:text-gray-500 mt-4">
            Supports PNG, JPG, WEBP â€¢ Max 10MB
          </p>
          <input
            id="fileInput"
            type="file"
            accept="image/*"
            class="hidden"
          />
        </div>

        <!-- Progress Loader -->
        <div id="loader" class="hidden">
          <div class="flex flex-col items-center justify-center py-16">
            <div class="relative">
              <svg class="progress-ring pulse-animation" width="120" height="120">
                <circle
                  class="progress-ring__circle"
                  stroke="url(#gradient)"
                  stroke-width="4"
                  fill="transparent"
                  r="40"
                  cx="60"
                  cy="60"
                />
                <defs>
                  <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="rgb(99, 102, 241)" />
                    <stop offset="100%" stop-color="rgb(236, 72, 153)" />
                  </linearGradient>
                </defs>
              </svg>
              <div class="absolute inset-0 flex items-center justify-center">
                <span id="progressText" class="text-2xl font-bold gradient-text">0%</span>
              </div>
            </div>
            <p class="mt-6 text-gray-600 dark:text-gray-400 text-lg">Processing your image...</p>
          </div>
        </div>

        <!-- Result -->
        <div id="resultWrapper" class="hidden">
          <div class="relative slide-up">
            <!-- Delete Button -->
            <button
              id="deleteBtn"
              class="absolute top-4 right-4 z-10 bg-gray-50 dark:bg-gray-800 rounded-full p-2 shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200"
              aria-label="Delete image"
            >
              <i class="ph ph-x text-xl text-gray-600 dark:text-gray-400 hover:text-red-500"></i>
            </button>

            <!-- Result Image -->
            <div class="rounded-2xl overflow-hidden shadow-2xl">
              <div class="relative bg-transparent" style="background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGElEQVQYlWNgYGCQwoKxgqGgcJA5h3yFAAs8BRWVSwooAAAAAElFTkSuQmCC'); background-size: 10px 10px;">
                <img
                  id="resultImage"
                  class="w-full"
                  alt="Processed image with transparent background"
                />
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-col sm:flex-row gap-4 mt-6">
              <a
                id="downloadBtn"
                href="#"
                download="removed-background.png"
                class="btn-primary flex-1 gradient-bg text-white rounded-xl px-6 py-4 flex items-center justify-center gap-3 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200"
              >
                <i class="ph-duotone ph-download-simple text-xl"></i>
                Download PNG
              </a>
              <button
                id="newImageBtn"
                class="flex-1 bg-gray-50 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl px-6 py-4 flex items-center justify-center gap-3 font-semibold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 border border-gray-200 dark:border-gray-700"
              >
                <i class="ph-duotone ph-plus-circle text-xl"></i>
                New Image
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="fixed bottom-0 left-0 right-0 p-4">
    <div class="flex justify-center">
      <a
        href="https://github.com/Saganaki22/RemoveBG"
        target="_blank"
        rel="noopener noreferrer"
        class="glass-github rounded-full px-6 py-3 flex items-center gap-2 text-gray-900 dark:text-gray-300 hover:text-indigo-600 dark:hover:text-indigo-400 hover:scale-105 transform transition-all duration-200 shadow-md group"
      >
        <i class="ph ph-github-logo text-xl text-gray-900 dark:text-gray-300 group-hover:text-indigo-600 dark:group-hover:text-indigo-400"></i>
        <span class="font-semibold">View on GitHub</span>
      </a>
    </div>
  </footer>

  <script type="module">
    // Import background removal library
    import * as BackgroundRemoval from "https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.6.0/+esm";
    const removeBackground =
      BackgroundRemoval.default && typeof BackgroundRemoval.default === "function"
        ? BackgroundRemoval.default
        : typeof BackgroundRemoval === "function"
        ? BackgroundRemoval
        : BackgroundRemoval.imglyRemoveBackground || BackgroundRemoval.removeBackground;

    if (typeof removeBackground !== "function") {
      console.error("Background removal module failed to load properly.");
    }

    // Device detection for model selection
    function isMobileOrTablet() {
      return /Mobi|Android|iPhone|iPad|iPod|Opera Mini|IEMobile|Mobile/i.test(navigator.userAgent);
    }

    // DOM elements
    const dropzone = document.getElementById("dropzone");
    const fileInput = document.getElementById("fileInput");
    const loader = document.getElementById("loader");
    const resultWrapper = document.getElementById("resultWrapper");
    const resultImage = document.getElementById("resultImage");
    const downloadBtn = document.getElementById("downloadBtn");
    const deleteBtn = document.getElementById("deleteBtn");
    const newImageBtn = document.getElementById("newImageBtn");
    const themeToggle = document.getElementById("themeToggle");
    const progressText = document.getElementById("progressText");

    // Theme management
    const initTheme = () => {
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark" || (!savedTheme && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
      }
    };

    themeToggle.addEventListener("click", () => {
      document.documentElement.classList.toggle("dark");
      localStorage.setItem("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
    });

    initTheme();

    // File handling
    const handleFiles = (files) => {
      if (!files || !files.length) return;
      const file = files[0];

      // Validate file
      if (!file.type.startsWith("image/")) {
        alert("Please upload an image file.");
        return;
      }

      if (file.size > 10 * 1024 * 1024) {
        alert("File size must be less than 10MB.");
        return;
      }

      processImage(file);
    };

    // Drag and drop
    dropzone.addEventListener("click", () => fileInput.click());
    fileInput.addEventListener("change", (e) => handleFiles(e.target.files));

    ["dragenter", "dragover"].forEach((evt) => {
      dropzone.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropzone.classList.add("dragover");
      });
    });

    ["dragleave", "drop"].forEach((evt) => {
      dropzone.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        dropzone.classList.remove("dragover");
      });
    });

    dropzone.addEventListener("drop", (e) => handleFiles(e.dataTransfer.files));

    // UI state management
    const showSection = (section) => {
      dropzone.classList.add("hidden");
      loader.classList.add("hidden");
      resultWrapper.classList.add("hidden");

      switch (section) {
        case "loader":
          loader.classList.remove("hidden");
          break;
        case "result":
          resultWrapper.classList.remove("hidden");
          break;
        default:
          dropzone.classList.remove("hidden");
      }
    };

    // Progress animation
    let currentProgress = 0;
    let progressTimer = null;
    
    const animateProgress = (targetPercent, duration = 2000) => {
      const circle = document.querySelector(".progress-ring__circle");
      const radius = circle.r.baseVal.value;
      const circumference = radius * 2 * Math.PI;
      
      const startProgress = currentProgress;
      const progressDiff = targetPercent - startProgress;
      const startTime = Date.now();

      circle.style.strokeDasharray = `${circumference} ${circumference}`;

      const updateProgress = () => {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        currentProgress = startProgress + (progressDiff * progress);
        
        const offset = circumference - (currentProgress / 100) * circumference;
        circle.style.strokeDashoffset = offset;
        progressText.textContent = `${Math.round(currentProgress)}%`;
        
        if (progress < 1) {
          progressTimer = requestAnimationFrame(updateProgress);
        }
      };
      
      updateProgress();
    };

    // Image processing with model selection
    const processImage = async (file) => {
      try {
        if (typeof removeBackground !== "function") {
          throw new Error("Background removal function not available.");
        }

        showSection("loader");
        currentProgress = 0;
        
        // Animate to 85% while processing (slower animation)
        animateProgress(85, 3000);

        // Choose model based on device
        const model = isMobileOrTablet() ? "small" : undefined;
        const options = model ? { model } : {};
        const blob = await removeBackground(file, options);
        
        // Cancel any ongoing animation
        if (progressTimer) {
          cancelAnimationFrame(progressTimer);
        }
        
        // Quickly animate from current progress to 100%
        await new Promise(resolve => {
          animateProgress(100, 500);
          setTimeout(resolve, 600); // Wait for animation to complete
        });

        const url = URL.createObjectURL(blob);
        resultImage.src = url;
        downloadBtn.href = url;
        
        // Generate filename based on original
        const originalName = file.name.split('.')[0];
        downloadBtn.download = `${originalName}-no-bg.png`;

        showSection("result");
      } catch (err) {
        console.error(err);
        alert("Failed to remove background. This may be due to an unsupported image format or a browser/device limitation. Please try converting your image to PNG or JPG, use a smaller image, or try a different browser/device.");
        showSection("default");
      }
    };

    // Reset functionality
    const resetApp = () => {
      if (resultImage.src.startsWith("blob:")) {
        URL.revokeObjectURL(resultImage.src);
      }
      resultImage.src = "";
      fileInput.value = "";
      progressText.textContent = "0%";
      currentProgress = 0;
      if (progressTimer) {
        cancelAnimationFrame(progressTimer);
      }
      showSection("default");
    };

    deleteBtn.addEventListener("click", resetApp);
    newImageBtn.addEventListener("click", resetApp);

    // Keyboard shortcuts
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && !resultWrapper.classList.contains("hidden")) {
        resetApp();
      }
    });

    // Set model indicator on page load
    function setModelIndicator() {
      const indicator = document.getElementById("modelIndicator");
      const label = document.getElementById("modelLabel");
      const isMobile = isMobileOrTablet();
      label.textContent = `Model: ${isMobile ? "Small" : "Medium"}`;
      indicator.style.display = "flex";
    }
    setModelIndicator();
  </script>
</body>
</html>
